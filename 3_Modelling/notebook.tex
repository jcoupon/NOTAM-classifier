
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Modelling}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{modelling}{%
\section{Modelling}\label{modelling}}

This notebook tests and describes the procedure to model the data.

    \hypertarget{preamble}{%
\subsection{Preamble}\label{preamble}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{} load basic libraries}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{k+kn}{import} \PY{n+nn}{sys}
        \PY{k+kn}{import} \PY{n+nn}{re}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{from} \PY{n+nn}{importlib} \PY{k}{import} \PY{n}{reload}
        
        \PY{c+c1}{\PYZsh{} load other libraries}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{pickle}
        
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{cluster}\PY{n+nn}{.}\PY{n+nn}{hierarchy} \PY{k}{import} \PY{n}{dendrogram}\PY{p}{,} \PY{n}{linkage}\PY{p}{,} \PY{n}{fcluster}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{CountVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfTransformer}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{KMeans}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{AgglomerativeClustering}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{TruncatedSVD}\PY{p}{,} \PY{n}{PCA}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{manifold} \PY{k}{import} \PY{n}{TSNE}
        
        
        \PY{c+c1}{\PYZsh{} add ./python to python path}
        \PY{n}{sys}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../python}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} load local libraries}
        \PY{k+kn}{import} \PY{n+nn}{cleaning}
        \PY{k+kn}{import} \PY{n+nn}{text\PYZus{}processing}
        \PY{k+kn}{import} \PY{n+nn}{modelling}
\end{Verbatim}


    \hypertarget{options}{%
\subsection{Options}\label{options}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{} options}
        \PY{n}{data\PYZus{}dir} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../0\PYZus{}data/training}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{c+c1}{\PYZsh{} input file}
        \PY{n}{path} \PY{o}{=} \PY{n}{data\PYZus{}dir}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/NOTAM.csv}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{c+c1}{\PYZsh{} intermediate files to train}
        \PY{c+c1}{\PYZsh{} and build the model}
        \PY{n}{path\PYZus{}train} \PY{o}{=} \PY{n}{path}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}train\PYZus{}clean.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{path\PYZus{}test} \PY{o}{=} \PY{n}{path}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}test\PYZus{}clean.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seaborn\PYZhy{}whitegrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pdf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fonttype}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
        \PY{n}{sns}\PY{o}{.}\PY{n}{mpl}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
        \PY{n}{sns}\PY{o}{.}\PY{n}{set\PYZus{}context}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{notebook}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{font\PYZus{}scale}\PY{o}{=}\PY{l+m+mf}{2.0}\PY{p}{,} \PY{n}{rc}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines.linewidth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{2.5}\PY{p}{\PYZcb{}}\PY{p}{)}
        
        \PY{n}{pd}\PY{o}{.}\PY{n}{set\PYZus{}option}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{display.max\PYZus{}columns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{)}
\end{Verbatim}


    \hypertarget{data-modelling}{%
\subsection{Data modelling}\label{data-modelling}}

The steps below describe how to run the modelling workflow. First split
the current into training and test sample to train the model, then
perform training and testing.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} define a random state for reproductability}
        \PY{n}{random\PYZus{}state} \PY{o}{=} \PY{l+m+mi}{20091982}
\end{Verbatim}


    \hypertarget{trainingtest-splitting}{%
\subsubsection{Training/test splitting}\label{trainingtest-splitting}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
            \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{item\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{df\PYZus{}train}\PY{p}{,} \PY{n}{df\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}
                \PY{n}{df}\PY{p}{,} \PY{n}{train\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{random\PYZus{}state}\PY{p}{)}
            \PY{n}{df\PYZus{}train}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{path\PYZus{}train}\PY{p}{)}
            \PY{n}{df\PYZus{}test}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{path\PYZus{}test}\PY{p}{)}
            
        \PY{k}{else}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} first run}
            \PY{c+c1}{\PYZsh{} python/split.py 0\PYZus{}Data/23\PYZhy{}08\PYZhy{}2018/Export.txt 0\PYZus{}Data/training/NOTAM\PYZus{}train.csv,0\PYZus{}Data/training/NOTAM\PYZus{}test.csv}
            \PY{c+c1}{\PYZsh{} and python/main.py clean 0\PYZus{}Data/training/NOTAM\PYZus{}train.csv}
            \PY{c+c1}{\PYZsh{} and python/main.py clean 0\PYZus{}Data/training/NOTAM\PYZus{}test.csv}
        
            \PY{n}{df\PYZus{}train} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path\PYZus{}train}\PY{p}{)}
            \PY{n}{df\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \hypertarget{training}{%
\subsubsection{Training}\label{training}}

The training phase will perform the following steps: * build a
dictionary from a csv file that contains the cleaned NOTAMs, * performs
hierarchical clustering,

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{} takes into account changes}
        \PY{c+c1}{\PYZsh{} made in the modelling.py file}
        \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} create model training object}
        \PY{n}{model\PYZus{}train} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{ModelTraining}\PY{p}{(}\PY{n}{path\PYZus{}train}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} build a vocabulary and saves it in python/}
        \PY{n}{model\PYZus{}train}\PY{o}{.}\PY{n}{build\PYZus{}vocabulary}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} vectorize the NOTAMs and do}
        \PY{c+c1}{\PYZsh{} dimensionality reduction}
        \PY{n}{model\PYZus{}train}\PY{o}{.}\PY{n}{vectorize}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} train and persist model}
        \PY{n}{model\PYZus{}train}\PY{o}{.}\PY{n}{cluster\PYZus{}train}\PY{p}{(}
            \PY{n}{path\PYZus{}train}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}model.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{n\PYZus{}samples}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Reading file{\ldots}done (found 78837 NOTAMs).
Building and saving the dictionary{\ldots}done.
Vectorizing the NOTAMs{\ldots}done.
Performing dimensionality reduction{\ldots}done.
Training (clusters){\ldots}done.

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{} optionally:}
        \PY{c+c1}{\PYZsh{} \PYZhy{} get the dictionary:}
        \PY{n}{vocabulary\PYZus{}dict} \PY{o}{=} \PY{n}{model\PYZus{}train}\PY{o}{.}\PY{n}{get\PYZus{}vocabulary\PYZus{}dict}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} \PYZhy{} get the word vector}
        \PY{n}{vector\PYZus{}train} \PY{o}{=} \PY{n}{model\PYZus{}train}\PY{o}{.}\PY{n}{get\PYZus{}vector}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} \PYZhy{} get the target (important/unimportant)}
        \PY{n}{target\PYZus{}train} \PY{o}{=} \PY{n}{model\PYZus{}train}\PY{o}{.}\PY{n}{get\PYZus{}df}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
\end{Verbatim}


    \hypertarget{testpredict}{%
\subsubsection{Test/predict}\label{testpredict}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} create model training object}
        \PY{n}{model\PYZus{}test} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{ModelTraining}\PY{p}{(}\PY{n}{path\PYZus{}test}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} vectorize the NOTAMs and do}
        \PY{c+c1}{\PYZsh{} dimensionality reduction}
        \PY{n}{model\PYZus{}test}\PY{o}{.}\PY{n}{vectorize}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Reading file{\ldots}done (found 19710 NOTAMs).
Vectorizing the NOTAMs{\ldots}done.
Performing dimensionality reduction{\ldots}done.

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} get the word vector and perform }
        \PY{c+c1}{\PYZsh{} t\PYZhy{}SNE manifold representation}
        \PY{c+c1}{\PYZsh{} for visualisation}
        \PY{n}{vector\PYZus{}test} \PY{o}{=} \PY{n}{model\PYZus{}test}\PY{o}{.}\PY{n}{get\PYZus{}vector}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{target\PYZus{}test} \PY{o}{=} \PY{n}{model\PYZus{}test}\PY{o}{.}\PY{n}{get\PYZus{}df}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{c+c1}{\PYZsh{} compute t\PYZhy{}SNE representation}
         \PY{c+c1}{\PYZsh{} additional info can be}
         \PY{c+c1}{\PYZsh{} found here https://distill.pub/2016/misread\PYZhy{}tsne/}
         
         \PY{c+c1}{\PYZsh{} drives the number of neighbours in t\PYZhy{}SNE}
         \PY{n}{perplexity} \PY{o}{=} \PY{l+m+mi}{100}
         
         \PY{c+c1}{\PYZsh{} file to store the t\PYZhy{}SNE results}
         \PY{n}{path\PYZus{}test\PYZus{}TSNE} \PY{o}{=} \PY{n}{path\PYZus{}test}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}TSNE\PYZus{}perp}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{perplexity}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} it takes about 30 mn so we save }
         \PY{c+c1}{\PYZsh{} the result to a file}
         \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
             \PY{n}{test\PYZus{}TSNE} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{tsne}\PY{p}{(}\PY{n}{vector\PYZus{}test}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{random\PYZus{}state}\PY{p}{,} \PY{n}{perplexity}\PY{o}{=}\PY{n}{perplexity}\PY{p}{)}
             \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test\PYZus{}TSNE}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{path\PYZus{}test\PYZus{}TSNE}\PY{p}{)}
         \PY{k}{else}\PY{p}{:}
             \PY{n}{test\PYZus{}TSNE} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{path\PYZus{}test\PYZus{}TSNE}\PY{p}{)}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} plot the t\PYZhy{}SNE representation}
         \PY{n}{path\PYZus{}test\PYZus{}html} \PY{o}{=} \PY{n}{path\PYZus{}test\PYZus{}TSNE}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.html}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{modelling}\PY{o}{.}\PY{n}{plot\PYZus{}clusters}\PY{p}{(}
             \PY{n}{test\PYZus{}TSNE}\PY{p}{,} \PY{n}{model\PYZus{}test}\PY{o}{.}\PY{n}{get\PYZus{}df}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} 
             \PY{n}{text}\PY{o}{=} \PY{n}{model\PYZus{}test}\PY{o}{.}\PY{n}{get\PYZus{}df}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fulltext}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{label\PYZus{}names}\PY{o}{=}\PY{p}{\PYZob{}}\PY{k+kc}{True}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{k+kc}{False}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unimportant}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
             \PY{n}{html\PYZus{}out}\PY{o}{=}\PY{n}{path\PYZus{}test\PYZus{}html}\PY{p}{,}
             \PY{n}{interactive}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{Verbatim}[commandchars=\\\{\}]
Plotting 9045 points with label Unimportant
Plotting 10665 points with label Important

    \end{Verbatim}

    \hypertarget{tests}{%
\subsection{Tests}\label{tests}}

The section performs a few tests.

    \hypertarget{line-breaks-for-plotting}{%
\subsubsection{Line breaks for
plotting}\label{line-breaks-for-plotting}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
         
         \PY{n}{text\PYZus{}test} \PY{o}{=} \PY{n}{model\PYZus{}test}\PY{o}{.}\PY{n}{get\PYZus{}df}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
         \PY{n}{text\PYZus{}test\PYZus{}breaks} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{break\PYZus{}lines}\PY{p}{(}\PY{n}{text\PYZus{}test}\PY{p}{)}
         
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{text\PYZus{}test}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{text\PYZus{}test\PYZus{}breaks}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
TWY B BTN RWY 17R/35L AND TWY M CLSD
TWY B BTN RWY 17R/35L AND TWY M CLSD

MBST/WS DETECTION SYSTEM NOT AVBL
MBST/WS DETECTION SYSTEM NOT AVBL

RWY 07/25 CLSD Z POWODU WIP.
RWY 07/25 CLSD Z POWODU WIP.

DANGER AREA EYD9 PABRADE ACT
DANGER AREA EYD9 PABRADE ACT

TWY R BTN TWY S14 AND TWY R10 CLSD. TWY S16 CLSD.
TWY R BTN TWY S14 AND TWY R10 CLSD. TWY S16 CLSD.

RWY 32 RWY END ID LGT U/S
RWY 32 RWY END ID LGT U/S

TWY N BTN TWY R AND TWY C CLSD
TWY N BTN TWY R AND TWY C CLSD

RACER SEVEN DEPARTURE{\ldots} BUTLER TRANSITION,SPRINGFIELD TRANSITION NA EXCEPT FOR AIRCRAFT EQUIPPED WITH SUITABLE RNAV SYSTEM WITH GPS. DOSOA TRANSITION DME REQUIRED EXCEPT FOR AIRCRAFT EQUIPPED WITH SUITABLE RNAV SYSTEM WITH GPS, BUM VORTAC U/S
RACER SEVEN DEPARTURE{\ldots} BUTLER TRANSITION,SPRINGFIELD TRANS<br>ITION NA EXCEPT FOR AIRCRAFT EQUIPPED WITH SUITABLE RNAV SYS<br>TEM WITH GPS. DOSOA TRANSITION DME REQUIRED EXCEPT FOR AIRCR<br>AFT EQUIPPED WITH SUITABLE RNAV SYSTEM WITH GPS, BUM VORTAC <br>U/S

RWY 16/34 CLSD AFTER LAST SKED FLT DUE WIP. AVBL WITH 30 MIN PN FOR CODE C ACFT AND SMALLER AND 60 MIN PN FOR CODE D ACFT AND LARGER, CONTACT ATC, TEL +64 4 387 1980. WHEN APPROVAL OBTAINED FOR CODE C ACFT AND SMALLER, THE FOLLOWING PROCEDURES APPLY: A YELLOW PAINTED TURNING CIRCLE HAS BEEN INSTALLED AT EACH END OF RWY 16/34 TO ALLOW ARRIVING ACFT TO BACKTRACK AND VACATE AND TO ALLOW DEPARTING ACFT TO ENTER VIA TWY A5 DUE TWY A WIP
RWY 16/34 CLSD AFTER LAST SKED FLT DUE WIP. AVBL WITH 30 MIN<br> PN FOR CODE C ACFT AND SMALLER AND 60 MIN PN FOR CODE D ACF<br>T AND LARGER, CONTACT ATC, TEL +64 4 387 1980. WHEN APPROVAL<br> OBTAINED FOR CODE C ACFT AND SMALLER, THE FOLLOWING PROCEDU<br>RES APPLY: A YELLOW PAINTED TURNING CIRCLE HAS BEEN INSTALLE<br>D AT EACH END OF RWY 16/34 TO ALLOW ARRIVING ACFT TO BACKTRA<br>CK AND VACATE AND TO ALLOW DEPARTING ACFT TO ENTER VIA TWY A<br>5 DUE TWY A WIP

VISOKA DREVESA PREBADAJO PRILETNO RAVNINO VPS 29 Z DESNE STRANI. POTREBNA JE PREVIDNOST PRI PRIHODU.
VISOKA DREVESA PREBADAJO PRILETNO RAVNINO VPS 29 Z DESNE STR<br>ANI. POTREBNA JE PREVIDNOST PRI PRIHODU.


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{df} \PY{o}{=} \PY{n}{model\PYZus{}train}\PY{o}{.}\PY{n}{get\PYZus{}df}\PY{p}{(}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:}          folder\_id              keyvalue  cat\_id                      svt  \textbackslash{}
         item\_id                                                                     
         4583789         -1  XXXX                       3  2018-06-07 03:59:00.000   
         4650267         -1  XXXX                       5  2018-06-27 13:00:00.000   
         4637946       2782  XXXX                       3  2018-06-25 12:00:00.000   
         4624075         -1  XXXX                       3  2018-06-19 07:50:00.000   
         4612312         -1  XXXX                       3  2018-06-13 10:28:00.000   
         
                                      evt  validfromt  validtot  profcat  active  \textbackslash{}
         item\_id                                                                   
         4583789  2038-01-01 00:00:00.000           0         0        2       1   
         4650267  2018-06-28 19:00:00.000           0         0        2       1   
         4637946  2018-06-28 21:00:00.000           0         0        2       0   
         4624075  2038-01-01 00:00:00.000           0         0        2       1   
         4612312  2038-01-01 00:00:00.000           0         0        2       0   
         
                 dataclass  wdays                      rvt  rvid  \textbackslash{}
         item\_id                                                   
         4583789      TXT     127  2018-06-07 11:15:00.000  1677   
         4650267      TXT     127  2018-06-27 05:08:00.000  1698   
         4637946      TXT     127  2018-06-28 18:01:00.000  1302   
         4624075      TXT     127  2018-06-19 10:14:00.000  1589   
         4612312      TXT     127  2018-08-11 09:24:00.000  1677   
         
                                      crt  crid source  vrnr  priority  spare  \textbackslash{}
         item\_id                                                                
         4583789  2018-06-07 04:03:00.000     1  EUC       1         1      0   
         4650267  2018-06-26 19:46:00.000     1  EUC       1         1      0   
         4637946  2018-06-22 12:57:00.000     1  EUC       1         1      0   
         4624075  2018-06-19 08:10:00.000     1  EUC       1         1      0   
         4612312  2018-06-15 08:04:00.000     1  EUC       1         1      1   
         
                 transcode  offical  supress areaissued notprefix notserial  notyear  \textbackslash{}
         item\_id                                                                       
         4583789         R        1        0       WRRR       WA      B4098       18   
         4650267         N        1        0       KZMA       KZ      A1037       18   
         4637946         N        1        0       KMIA       KZ      A2005       18   
         4624075         R        1        0       OPKC       OP      A0588       18   
         4612312         R        1        0       HECA       HE      A0169       18   
         
                 partno notamcode trafficind notpurpose notscope  minflt  maxflt  subj  \textbackslash{}
         item\_id                                                                         
         4583789            QLFAS         I         BO        A        0     999   NaN   
         4650267            QRACA         I         NBO       W        0     999   NaN   
         4637946            QMXHW         IV        M         A        0     999   NaN   
         4624075            QMNHW         IV        BO        A        0     999   NaN   
         4612312            QPDXX         I         NBO       A        0     999   NaN   
         
                  briefingcard  printcat  IsNew  qsign  qstat    lat    lng  radius  \textbackslash{}
         item\_id                                                                      
         4583789             0        -1      0    NaN    NaN  -5110  84250       5   
         4650267             0        -1      0    NaN    NaN  16580 -48730      24   
         4637946             0        -1      0    NaN    NaN  15480 -48170       5   
         4624075             0        -1      0    NaN    NaN  18150  40160       5   
         4612312             0        -1      0    NaN    NaN  14380  19690       5   
         
                  severity  last\_modified\_dt             EstimatedEvt  item\_id\_1  \textbackslash{}
         item\_id                                                                   
         4583789         0               NaN  2018-09-06 08:00:00.000    4583789   
         4650267         0               NaN                      NaN    4650267   
         4637946         0               NaN                      NaN    4637946   
         4624075         0               NaN  2018-09-20 23:59:00.000    4624075   
         4612312         0               NaN  2019-09-01 08:00:00.000    4612312   
         
                                                           fulltext  txt\_id  \textbackslash{}
         item\_id                                                              
         4583789  B4098/18 NOTAMR B1528/18 Q)WAAF/QLFAS/I/BO/A/0{\ldots}      11   
         4650267  A1037/18 NOTAMN Q)KZMA/QRACA/I/NBO/W/000/999/2{\ldots}      11   
         4637946  A2005/18 NOTAMN Q)KZMA/QMXHW/IV/M/A/000/999/25{\ldots}      11   
         4624075  A0588/18 NOTAMR A0247/18 Q)OPLR/QMNHW/IV/BO/A/{\ldots}      11   
         4612312  A0169/18 NOTAMR A0254/17 Q)HECC/QPDXX/I/NBO/A/{\ldots}      11   
         
                     HEX(id)                                               text  \textbackslash{}
         item\_id                                                                  
         4583789  0x00003F3F  SQFL (SEQUENCE FLASHING LIGHTS) RWY 16 U/S DUE{\ldots}   
         4650267  0x00003F3F  AIRSPACE RESERVATION AVON HI COMPLEX ACT. MIAM{\ldots}   
         4637946  0x00003F3F                             TWY ALL WIP INSPECTION   
         4624075  0x00003F3F   FOKKER/ATR APRON NOT AVBL DUE REHABILITATION WIP   
         4612312  0x00003F3F                            AIP SUP 15/14 EXTENDED.   
         
                                                         text\_clean  important  
         item\_id                                                                
         4583789  sqfl  sfl  rwy <num> u s due to electrical pro{\ldots}       True  
         4650267  airspace rsvn avon hi complex act  miami cente{\ldots}       True  
         4637946                             twy all wip inspection       True  
         4624075   fokker atr apron not avbl due rehabilitation wip       True  
         4612312                      aip sup <num> <num> extended        True  
\end{Verbatim}
            
    \hypertarget{word-counts}{%
\subsubsection{Word counts}\label{word-counts}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{} word counts}
         \PY{c+c1}{\PYZsh{} TODO: try 2\PYZhy{}gram}
         \PY{c+c1}{\PYZsh{} vectorizer = CountVectorizer(ngram\PYZus{}range=(1, 2), token\PYZus{}pattern=r\PYZsq{}\PYZbs{}b\PYZbs{}w+\PYZbs{}b\PYZsq{}, min\PYZus{}df=1)}
         \PY{n}{vectorizer} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} get the NOTAMS as a corpus}
         \PY{n}{corpus} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text\PYZus{}clean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{values}
         \PY{n}{word\PYZus{}counts} \PY{o}{=} \PY{n}{vectorizer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{corpus}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{} what are the typical words that appear most frequently?}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{word\PYZus{}counts}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n}{word\PYZus{}total\PYZus{}counts} \PY{o}{=} \PY{n}{word\PYZus{}counts}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} sorted indexes (most frequent first)}
         \PY{n}{word\PYZus{}total\PYZus{}counts\PYZus{}sorted} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{word\PYZus{}total\PYZus{}counts}\PY{p}{)}
         \PY{n}{word\PYZus{}total\PYZus{}counts\PYZus{}sorted\PYZus{}ids} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{word\PYZus{}total\PYZus{}counts}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(78837, 25419)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{inverse\PYZus{}dictionary} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{v}\PY{p}{:}\PY{n}{k} \PY{k}{for} \PY{p}{(}\PY{n}{k}\PY{p}{,}\PY{n}{v}\PY{p}{)} \PY{o+ow}{in} \PY{n}{vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{\PYZcb{}}
\end{Verbatim}


    \hypertarget{most-frequent-words}{%
\subsubsection{Most frequent words}\label{most-frequent-words}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{n\PYZus{}most\PYZus{}frequent} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{most\PYZus{}frequent} \PY{o}{=} \PY{n}{word\PYZus{}counts}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{word\PYZus{}total\PYZus{}counts\PYZus{}sorted\PYZus{}ids}\PY{p}{[}\PY{p}{:}\PY{n}{n\PYZus{}most\PYZus{}frequent}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{cov} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{corrcoef}\PY{p}{(}\PY{n}{most\PYZus{}frequent}\PY{p}{,} \PY{n}{rowvar}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{cov}\PY{p}{)}
         \PY{k+kc}{None}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_27_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{feature\PYZus{}most\PYZus{}frequent} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{index} \PY{o+ow}{in} \PY{n}{word\PYZus{}total\PYZus{}counts\PYZus{}sorted\PYZus{}ids}\PY{p}{[}\PY{p}{:}\PY{n}{n\PYZus{}most\PYZus{}frequent}\PY{p}{]}\PY{p}{:}
             \PY{n}{feature\PYZus{}most\PYZus{}frequent}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{inverse\PYZus{}dictionary}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{)}
         \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{feature\PYZus{}most\PYZus{}frequent}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:} array(['num', 'coord', 'rwy', 'twy', 'clsd', 'area', 'fl', 'acft', 'btn',
                'avbl', 'wi', 'ft', 'nm', 'act', 'radius', 'ad', 'ils', 'aip',
                'gps', 'mil', 'mhz', 'dme', 'rte', 'flt', 'activated', 'amsl',
                'wip', 'airspace', 'wet', 'flw', 'exc', 'obs', 'svc', 'place',
                'km', 'fm', 'agl', 'vor', 'ref', 'sfc', 'dct', 'pct', 'info',
                'raim', 'restricted', 'rmk', 'maint', 'cat', 'radar', 'amdt',
                'tempo', 'atc', 'psn', 'ep', 'apch', 'lgt', 'loc', 'hr', 'freq',
                'ops', 'twr', 'rnav', 'circle', 'min', 'expect', 'proc', 'tfc',
                'ats', 'notam', 'opr', 'vectoring', 'danger', 'detection', 'end',
                'centre', 'ctl', 'line', 'jun', 'fir', 'point', 'fault', 'nr',
                'ch', 'tso', 'hours', 'outages', 'obst', 'alt', 'enr', 'ausots',
                'sup', 'civ', 'coor', 'dep', 'centered', 'points', 'equipped',
                'frng', 'departure', 'air'], dtype='<U10')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{} most correlated words among top most frequent}
         \PY{n}{indexes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{unravel\PYZus{}index}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{cov}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{cov}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n}{select} \PY{o}{=} \PY{p}{(}\PY{n}{indexes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{!=} \PY{n}{indexes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{indexes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{indexes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{indexes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{n}{select}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}\PY{p}{,} \PY{n}{indexes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{n}{select}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}
                 \PY{n}{feature\PYZus{}most\PYZus{}frequent}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{upper}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                 \PY{n}{feature\PYZus{}most\PYZus{}frequent}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{upper}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.2\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{cov}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{j}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
TSO OUTAGES 0.99
DETECTION FAULT 0.98
FAULT OUTAGES 0.98
FAULT TSO 0.98
DETECTION OUTAGES 0.96
DETECTION TSO 0.96
RAIM FAULT 0.95
RAIM OUTAGES 0.95
RAIM TSO 0.95
EXPECT VECTORING 0.94
RAIM DETECTION 0.94
WET OBS 0.91
GPS RAIM 0.88
WET PCT 0.85
DCT EP 0.85
GPS TSO 0.85
GPS OUTAGES 0.84
GPS FAULT 0.84
GPS DETECTION 0.82
OBS PCT 0.78
LINE POINTS 0.75
AMSL FM 0.75
FT AMSL 0.75
RADAR VECTORING 0.74
RADAR EXPECT 0.71
RNAV EQUIPPED 0.7
CIV COOR 0.69
CIRCLE CENTRE 0.69
NM FM 0.67
ILS LOC 0.66
FT FM 0.65
MIL CIV 0.65
FLT COOR 0.64
FT NM 0.64
NM AMSL 0.63
MIL COOR 0.63
TWY BTN 0.61
AIP SUP 0.6
VECTORING FRNG 0.59
FLT CIV 0.58
EXC EQUIPPED 0.57
MIL FLT 0.57
EXPECT FRNG 0.56
ACTIVATED VECTORING 0.56
ACTIVATED EXPECT 0.54
ILS AMDT 0.53
RTE DCT 0.51
COORD POINTS 0.51
WI CENTRE 0.51
RADIUS CENTERED 0.5
DME VOR 0.5
COORD LINE 0.5
WI AIRSPACE 0.5
RADIUS CIRCLE 0.5
RTE EP 0.49
MHZ FREQ 0.49
ATC COOR 0.49
WI RADIUS 0.49
COORD WI 0.49
AMDT LOC 0.48
MIL ATC 0.48
WI CIRCLE 0.48
ATC CIV 0.46
FLT ATC 0.45
EQUIPPED DEPARTURE 0.45
RADAR FRNG 0.44
AIP REF 0.43
AIRSPACE CENTRE 0.43
ACTIVATED RADAR 0.43
FL EP 0.43
WI POINTS 0.43
RESTRICTED FRNG 0.42
EXC RNAV 0.41
FT OBST 0.4
WI LINE 0.4
FL DCT 0.4
AREA ACTIVATED 0.4
ACTIVATED FRNG 0.4
COORD AIRSPACE 0.4
NUM AIP 0.4
ACTIVATED TEMPO 0.4
ACTIVATED RESTRICTED 0.39
TWY CLSD 0.39
RADIUS CENTRE 0.39
KM CENTRE 0.38
RNAV DEPARTURE 0.38
AREA RESTRICTED 0.38
AREA TEMPO 0.38
RADIUS AGL 0.38
NM RADIUS 0.37
AIRSPACE CIRCLE 0.37
MIN ALT 0.37
RWY ILS 0.37
FLW POINTS 0.36
RESTRICTED VECTORING 0.36
AD REF 0.36
DME CH 0.36
KM CIRCLE 0.36
RMK AUSOTS 0.36
COORD FLW 0.36

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{Z} \PY{o}{=} \PY{n}{linkage}\PY{p}{(}\PY{n}{cov}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ward}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}
         \PY{n}{dn} \PY{o}{=} \PY{n}{dendrogram}\PY{p}{(}\PY{n}{Z}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{feature\PYZus{}most\PYZus{}frequent}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{which}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{major}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_30_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{notam-clustering}{%
\subsection{NOTAM clustering}\label{notam-clustering}}

    \hypertarget{k-means-tests}{%
\subsubsection{K-means tests}\label{k-means-tests}}

We use the Elbow method to determine the number of typical clusters. 4
seems to be a good choice, but we see from the t-SNE projection that the
clusters are not so relevant.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
             \PY{n}{inertia} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{k}\PY{p}{)}
                 \PY{n}{kmeans} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{n}{k}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{20091982}\PY{p}{)}
                 \PY{n}{kmeans}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{vector\PYZus{}train}\PY{p}{)}
                 \PY{n}{inertia}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{kmeans}\PY{o}{.}\PY{n}{inertia\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{inertia}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inertia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k+kc}{None}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_34_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
         
         \PY{n}{n\PYZus{}clusters} \PY{o}{=} \PY{l+m+mi}{50}
         
         \PY{c+c1}{\PYZsh{} run K\PYZhy{}means with n\PYZus{}clusters}
         \PY{n}{path\PYZus{}out} \PY{o}{=} \PY{n}{data\PYZus{}dir}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/cluster\PYZus{}kmeans\PYZus{}k}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{p}{)}
         \PY{n}{model\PYZus{}options\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{n\PYZus{}clusters}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random\PYZus{}state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{random\PYZus{}state}\PY{p}{\PYZcb{}}
         \PY{n}{model} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{cluster\PYZus{}train}\PY{p}{(}
             \PY{n}{vector\PYZus{}train}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kmeans}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{model\PYZus{}options\PYZus{}dict}\PY{o}{=}\PY{n}{model\PYZus{}options\PYZus{}dict}\PY{p}{,} \PY{n}{path\PYZus{}out}\PY{o}{=}\PY{n}{path\PYZus{}out}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} evaluate test sample}
         \PY{n}{labels\PYZus{}test} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{find\PYZus{}clusters\PYZus{}predict}\PY{p}{(}\PY{n}{vector\PYZus{}test}\PY{p}{,} \PY{n}{path\PYZus{}out}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kmeans}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{np}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{n}{labels\PYZus{}test}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}90}]:} array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
                17, 18, 19, 20, 21, 22, 24, 25, 27, 29, 30, 31, 34, 35, 36, 39, 40,
                42, 45], dtype=int32)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} plot the t\PYZhy{}SNE representation}
         \PY{n}{path\PYZus{}tsne\PYZus{}html} \PY{o}{=} \PY{n}{path\PYZus{}tsne}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}kmeans\PYZus{}k}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{.html}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{p}{)}\PY{p}{)}
         \PY{n}{modelling}\PY{o}{.}\PY{n}{plot\PYZus{}clusters}\PY{p}{(}
             \PY{n}{tsne\PYZus{}test}\PY{p}{,} \PY{n}{labels\PYZus{}test}\PY{p}{,}
             \PY{n}{text}\PY{o}{=}\PY{n}{model\PYZus{}test}\PY{o}{.}\PY{n}{get\PYZus{}df}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fulltext}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{html\PYZus{}out}\PY{o}{=}\PY{n}{path\PYZus{}tsne\PYZus{}html}\PY{p}{,}
             \PY{n}{interactive}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{Verbatim}[commandchars=\\\{\}]
Plotting 2684 points with label 0
Plotting 1 points with label 1
Plotting 23 points with label 2
Plotting 1 points with label 3
Plotting 564 points with label 4
Plotting 16 points with label 5
Plotting 57 points with label 6
Plotting 1 points with label 7
Plotting 182 points with label 8
Plotting 8 points with label 9
Plotting 1325 points with label 10
Plotting 1176 points with label 11
Plotting 3 points with label 12
Plotting 76 points with label 13
Plotting 260 points with label 14
Plotting 1 points with label 15
Plotting 9 points with label 16
Plotting 12 points with label 17
Plotting 12 points with label 18
Plotting 517 points with label 19
Plotting 57 points with label 20
Plotting 167 points with label 21
Plotting 108 points with label 22
Plotting 1129 points with label 24
Plotting 4 points with label 25
Plotting 27 points with label 27
Plotting 14 points with label 29
Plotting 10 points with label 30
Plotting 2670 points with label 31
Plotting 8169 points with label 34
Plotting 161 points with label 35
Plotting 33 points with label 36
Plotting 7 points with label 39
Plotting 13 points with label 40
Plotting 153 points with label 42
Plotting 60 points with label 45

    \end{Verbatim}

    \hypertarget{hierarchical-clustering-tests}{%
\subsubsection{Hierarchical clustering
tests}\label{hierarchical-clustering-tests}}

We test the hierarchical clustering.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{} first we compute the hierarchical}
         \PY{c+c1}{\PYZsh{} clusters and distances}
         \PY{c+c1}{\PYZsh{} we only use a sub set for }
         \PY{c+c1}{\PYZsh{} this step as it is time consuming}
         
         \PY{n}{choice} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{vector\PYZus{}train}\PY{p}{)}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{)}
         \PY{n}{Z} \PY{o}{=} \PY{n}{linkage}\PY{p}{(}\PY{n}{vector\PYZus{}train}\PY{p}{[}\PY{n}{choice}\PY{p}{,} \PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ward}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{c+c1}{\PYZsh{} then we compute number of clusters }
         \PY{c+c1}{\PYZsh{} at each stage, or:}
         \PY{c+c1}{\PYZsh{} how many clusters are there with }
         \PY{c+c1}{\PYZsh{} larger distance than d?}
         \PY{n}{n\PYZus{}clusters\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{d} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}\PY{p}{:}
             \PY{n}{n\PYZus{}clusters} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{Z}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{d}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{d}\PY{p}{)}\PY{p}{)}
             \PY{n}{n\PYZus{}clusters\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{p}{)}
             
         \PY{n}{n\PYZus{}clusters\PYZus{}list} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{n}{n\PYZus{}clusters\PYZus{}list}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
2764 1.00
2400 1.27
2037 1.61
1638 2.04
1310 2.59
1037 3.29
810 4.18
624 5.30
479 6.72
371 8.53
277 10.83
209 13.74
154 17.43
112 22.12
84 28.07
65 35.62
48 45.20
35 57.36
26 72.79
18 92.37
13 117.21
13 148.74
9 188.74
8 239.50
4 303.92
3 385.66
3 489.39
2 621.02
2 788.05
1 1000.00

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{c+c1}{\PYZsh{} visualize the clusters}
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{dn} \PY{o}{=} \PY{n}{dendrogram}\PY{p}{(}\PY{n}{Z}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{no\PYZus{}labels}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{color\PYZus{}threshold}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}
         \PY{k+kc}{None}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_41_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
         
         \PY{k}{def} \PY{n+nf}{cluster\PYZus{}purity}\PY{p}{(}\PY{n}{vector}\PY{p}{,} \PY{n}{target}\PY{p}{,} \PY{n}{k}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Compute the clusters}
         \PY{l+s+sd}{    and measure the purity}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
         
             \PY{n}{choice} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{vector\PYZus{}train}\PY{p}{)}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{n}{size}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} run hierachical clustering}
             \PY{n}{model\PYZus{}options\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{k}\PY{p}{\PYZcb{}}
             \PY{n}{model} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{find\PYZus{}clusters\PYZus{}train}\PY{p}{(}
                 \PY{n}{vector}\PY{p}{[}\PY{n}{choice}\PY{p}{,} \PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hierarchical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{model\PYZus{}options\PYZus{}dict}\PY{o}{=}\PY{n}{model\PYZus{}options\PYZus{}dict}\PY{p}{)}
             
             \PY{n}{labels} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{labels\PYZus{}}
             \PY{n}{classes} \PY{o}{=} \PY{n}{target}\PY{p}{[}\PY{n}{choice}\PY{p}{]}
         
             \PY{n}{N}\PY{p}{,} \PY{n}{purity}\PY{p}{,} \PY{n}{f\PYZus{}pure} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{get\PYZus{}cluster\PYZus{}purity}\PY{p}{(}\PY{n}{labels}\PY{p}{,} \PY{n}{classes}\PY{p}{)}
         
             \PY{k}{return} \PY{n}{N}\PY{p}{,} \PY{n}{purity}\PY{p}{,} \PY{n}{f\PYZus{}pure}
         
         \PY{n}{N\PYZus{}4}\PY{p}{,} \PY{n}{purity\PYZus{}4}\PY{p}{,} \PY{n}{f\PYZus{}pure\PYZus{}4} \PY{o}{=} \PY{n}{cluster\PYZus{}purity}\PY{p}{(}\PY{n}{vector\PYZus{}train}\PY{p}{,} \PY{n}{target\PYZus{}train}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}
         \PY{n}{N\PYZus{}50}\PY{p}{,} \PY{n}{purity\PYZus{}50}\PY{p}{,} \PY{n}{f\PYZus{}pure\PYZus{}50} \PY{o}{=} \PY{n}{cluster\PYZus{}purity}\PY{p}{(}\PY{n}{vector\PYZus{}train}\PY{p}{,} \PY{n}{target\PYZus{}train}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{,} \PY{n}{sharex}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{purity\PYZus{}4}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{N\PYZus{}4}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Purity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{purity\PYZus{}50}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{N\PYZus{}50}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Purity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{k+kc}{None}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_43_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{n}{f\PYZus{}pure\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n}{n\PYZus{}clusters\PYZus{}list}\PY{p}{:}
             \PY{n}{N}\PY{p}{,} \PY{n}{purity}\PY{p}{,} \PY{n}{f\PYZus{}pure} \PY{o}{=} \PY{n}{cluster\PYZus{}purity}\PY{p}{(}\PY{n}{vector\PYZus{}train}\PY{p}{,} \PY{n}{target\PYZus{}train}\PY{p}{,} \PY{n}{k}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{)}
             \PY{n}{f\PYZus{}pure\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{f\PYZus{}pure}\PY{p}{)}
             
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{k}\PY{p}{,} \PY{n}{f\PYZus{}pure}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
1 0.0
2 0.0007
3 0.0007
5 0.0014
6 0.0013
9 0.0509
11 0.0551
12 0.0502
18 0.0661
25 0.1494
34 0.1703
50 0.3774
65 0.4243
83 0.4358
110 0.4823
148 0.5063
203 0.553
276 0.5765
370 0.5731
477 0.5871
632 0.6051
798 0.6401
1051 0.6546
1331 0.7073
1653 0.6985
2063 0.7077
2419 0.7598
2783 0.812

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{n\PYZus{}clusters\PYZus{}list}\PY{p}{,} \PY{n}{f\PYZus{}pure\PYZus{}list}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weighted fraction of pure (\PYZgt{}80}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{) clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} test with 50 clusters on the test sample}
         \PY{c+c1}{\PYZsh{}choice = np.random.choice(len(vector\PYZus{}test), size=100)}
         \PY{n}{choice} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{vector\PYZus{}test}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{n\PYZus{}clusters} \PY{o}{=} \PY{l+m+mi}{50}
         
         \PY{c+c1}{\PYZsh{} run hierachical clustering}
         \PY{n}{path\PYZus{}out} \PY{o}{=} \PY{n}{data\PYZus{}dir}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/cluster\PYZus{}hierach\PYZus{}k}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{p}{)}
         \PY{n}{model\PYZus{}options\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{n\PYZus{}clusters}\PY{p}{\PYZcb{}}
         \PY{n}{model} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{find\PYZus{}clusters\PYZus{}train}\PY{p}{(}
             \PY{n}{vector\PYZus{}test}\PY{p}{[}\PY{n}{choice}\PY{p}{,} \PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hierarchical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{model\PYZus{}options\PYZus{}dict}\PY{o}{=}\PY{n}{model\PYZus{}options\PYZus{}dict}\PY{p}{,} \PY{n}{path\PYZus{}out}\PY{o}{=}\PY{n}{path\PYZus{}out}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} plot the t\PYZhy{}SNE representation}
         \PY{n}{path\PYZus{}tsne\PYZus{}html} \PY{o}{=} \PY{n}{path\PYZus{}test\PYZus{}TSNE}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}hierach\PYZus{}k}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{.html}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{p}{)}\PY{p}{)}
         \PY{n}{modelling}\PY{o}{.}\PY{n}{plot\PYZus{}clusters}\PY{p}{(}
             \PY{n}{test\PYZus{}TSNE}\PY{p}{[}\PY{n}{choice}\PY{p}{,} \PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{labels\PYZus{}}\PY{p}{,}
             \PY{n}{text}\PY{o}{=}\PY{n}{model\PYZus{}test}\PY{o}{.}\PY{n}{get\PYZus{}df}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fulltext}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{choice}\PY{p}{]}\PY{p}{,}
             \PY{n}{html\PYZus{}out}\PY{o}{=}\PY{n}{path\PYZus{}tsne\PYZus{}html}\PY{p}{,}
             \PY{n}{interactive}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{Verbatim}[commandchars=\\\{\}]
Plotting 14 points with label 0
Plotting 316 points with label 1
Plotting 12 points with label 2
Plotting 3929 points with label 3
Plotting 353 points with label 4
Plotting 52 points with label 5
Plotting 10 points with label 6
Plotting 1698 points with label 7
Plotting 152 points with label 8
Plotting 4 points with label 9
Plotting 7 points with label 10
Plotting 1521 points with label 11
Plotting 3 points with label 12
Plotting 25 points with label 13
Plotting 108 points with label 14
Plotting 339 points with label 15
Plotting 1916 points with label 16
Plotting 18 points with label 17
Plotting 132 points with label 18
Plotting 6 points with label 19
Plotting 74 points with label 20
Plotting 922 points with label 21
Plotting 2992 points with label 22
Plotting 19 points with label 23
Plotting 6 points with label 24
Plotting 53 points with label 25
Plotting 15 points with label 26
Plotting 43 points with label 27
Plotting 139 points with label 28
Plotting 1 points with label 29
Plotting 21 points with label 30
Plotting 1 points with label 31
Plotting 1 points with label 32
Plotting 438 points with label 33
Plotting 198 points with label 34
Plotting 187 points with label 35
Plotting 246 points with label 36
Plotting 1 points with label 37
Plotting 64 points with label 38
Plotting 1 points with label 39
Plotting 2 points with label 40
Plotting 322 points with label 41
Plotting 3200 points with label 42
Plotting 3 points with label 43
Plotting 5 points with label 44
Plotting 120 points with label 45
Plotting 4 points with label 46
Plotting 1 points with label 47
Plotting 15 points with label 48
Plotting 1 points with label 49

    \end{Verbatim}

    \hypertarget{training-tests}{%
\subsubsection{Training tests}\label{training-tests}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{c+c1}{\PYZsh{} run python/main.py train 0\PYZus{}Data/training/NOTAM\PYZus{}train\PYZus{}clean.csv \PYZhy{}n\PYZus{}samples 100}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
         
         \PY{n}{path\PYZus{}in} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{c+c1}{\PYZsh{} read model}
         \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{path\PYZus{}in}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{file\PYZus{}in}\PY{p}{:}
             \PY{n}{vector\PYZus{}train}\PY{p}{,} \PY{n}{labels\PYZus{}train} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{file\PYZus{}in}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        FileNotFoundError                         Traceback (most recent call last)

        <ipython-input-13-e3e0bafd10df> in <module>()
          4 
          5 \# read model
    ----> 6 with open(path\_in, 'rb') as file\_in:
          7     vector\_train, labels\_train = pickle.load(file\_in)


        FileNotFoundError: [Errno 2] No such file or directory: ''

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}220}]:} \PY{n}{reload}\PY{p}{(}\PY{n}{modelling}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} try with X\PYZus{}train\PYZus{}50}
          
          \PY{c+c1}{\PYZsh{} run hierachical clustering with 4 clusters}
          \PY{n}{path\PYZus{}out} \PY{o}{=} \PY{n}{data\PYZus{}dir}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/23\PYZhy{}08\PYZhy{}2018/cluster\PYZus{}hierarchical\PYZus{}k7.pickle}\PY{l+s+s1}{\PYZsq{}}
          \PY{n}{model\PYZus{}options\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{55}\PY{p}{\PYZcb{}}
          \PY{n}{model} \PY{o}{=} \PY{n}{modelling}\PY{o}{.}\PY{n}{cluster\PYZus{}train}\PY{p}{(}
              \PY{n}{X\PYZus{}test\PYZus{}50}\PY{p}{,} \PY{n}{n\PYZus{}samples}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{model\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hierarchical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{model\PYZus{}options\PYZus{}dict}\PY{o}{=}\PY{n}{model\PYZus{}options\PYZus{}dict}\PY{p}{,} \PY{n}{path\PYZus{}out}\PY{o}{=}\PY{n}{path\PYZus{}out}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}221}]:} \PY{n}{np}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{labels\PYZus{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}221}]:} array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
                 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
                 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
                 51, 52, 53, 54])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}222}]:} \PY{c+c1}{\PYZsh{}n = 1000}
          \PY{n}{modelling}\PY{o}{.}\PY{n}{plot\PYZus{}clusters}\PY{p}{(}
              \PY{n}{X\PYZus{}test}\PY{p}{,}  \PY{n}{model}\PY{o}{.}\PY{n}{labels\PYZus{}}\PY{p}{,} \PY{n}{text}\PY{o}{=}\PY{n}{text\PYZus{}test}\PY{p}{,}
              \PY{n}{html\PYZus{}out}\PY{o}{=}\PY{n}{path\PYZus{}out}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.pickle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.html}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} 
              \PY{n}{X\PYZus{}decomposed}\PY{o}{=}\PY{n}{X\PYZus{}test\PYZus{}TSNE}\PY{p}{,}
              \PY{n}{interactive}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{20091982}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{Verbatim}[commandchars=\\\{\}]
Plotting 4 points with label 0
Plotting 52 points with label 1
Plotting 102 points with label 2
Plotting 3805 points with label 3
Plotting 315 points with label 4
Plotting 93 points with label 5
Plotting 21 points with label 6
Plotting 234 points with label 7
Plotting 19 points with label 8
Plotting 7 points with label 9
Plotting 4 points with label 10
Plotting 1039 points with label 11
Plotting 15 points with label 12
Plotting 139 points with label 13
Plotting 201 points with label 14
Plotting 18 points with label 15
Plotting 1115 points with label 16
Plotting 8 points with label 17
Plotting 30 points with label 18
Plotting 362 points with label 19
Plotting 86 points with label 20
Plotting 57 points with label 21
Plotting 2995 points with label 22
Plotting 100 points with label 23
Plotting 1289 points with label 24
Plotting 3 points with label 25
Plotting 63 points with label 26
Plotting 1 points with label 27
Plotting 43 points with label 28
Plotting 1 points with label 29
Plotting 1 points with label 30
Plotting 1 points with label 31
Plotting 439 points with label 32
Plotting 1 points with label 33
Plotting 1879 points with label 34
Plotting 187 points with label 35
Plotting 64 points with label 36
Plotting 3398 points with label 37
Plotting 246 points with label 38
Plotting 2 points with label 39
Plotting 6 points with label 40
Plotting 13 points with label 41
Plotting 62 points with label 42
Plotting 325 points with label 43
Plotting 5 points with label 44
Plotting 120 points with label 45
Plotting 3 points with label 46
Plotting 1 points with label 47
Plotting 4 points with label 48
Plotting 1 points with label 49
Plotting 6 points with label 50
Plotting 1 points with label 51
Plotting 15 points with label 52
Plotting 3 points with label 53
Plotting 706 points with label 54

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}223}]:} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{supress\PYZus{}test} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}223}]:} 10665
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}224}]:} \PY{n}{label\PYZus{}types} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{labels\PYZus{}}\PY{p}{)}
          \PY{n}{n\PYZus{}labels} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{label\PYZus{}types}\PY{p}{)}
          \PY{n}{N} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{n\PYZus{}labels}\PY{p}{)}
          \PY{n}{purity} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{n\PYZus{}labels}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{n}{l} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{label\PYZus{}types}\PY{p}{)}\PY{p}{:}
              
              \PY{n}{select} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{labels\PYZus{}} \PY{o}{==} \PY{n}{l}
              \PY{n}{N}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{select}\PY{p}{)}
              
              \PY{c+c1}{\PYZsh{}print(N, sum(supress\PYZus{}test.iloc[select] == 1))}
              
              \PY{n}{f\PYZus{}important} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{supress\PYZus{}test}\PY{p}{[}\PY{n}{select}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{)}\PY{o}{/}\PY{n}{N}\PY{p}{[}\PY{n}{i}\PY{p}{]}
              \PY{n}{f\PYZus{}unimportant} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{supress\PYZus{}test}\PY{p}{[}\PY{n}{select}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}\PY{o}{/}\PY{n}{N}\PY{p}{[}\PY{n}{i}\PY{p}{]}
              
              \PY{n}{purity}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n}{f\PYZus{}important}\PY{p}{,} \PY{n}{f\PYZus{}unimportant}\PY{p}{)}
              
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{N}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{purity}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
4.0 1.00
52.0 1.00
102.0 0.52
3805.0 0.62
315.0 0.95
93.0 0.56
21.0 0.71
234.0 0.52
19.0 0.74
7.0 1.00
4.0 1.00
1039.0 0.55
15.0 0.87
139.0 1.00
201.0 0.88
18.0 0.94
1115.0 0.58
8.0 1.00
30.0 0.57
362.0 0.58
86.0 0.52
57.0 0.58
2995.0 0.64
100.0 1.00
1289.0 0.94
3.0 0.67
63.0 0.78
1.0 1.00
43.0 1.00
1.0 1.00
1.0 1.00
1.0 1.00
439.0 0.84
1.0 1.00
1879.0 0.53
187.0 0.96
64.0 0.97
3398.0 0.88
246.0 1.00
2.0 1.00
6.0 1.00
13.0 1.00
62.0 0.92
325.0 1.00
5.0 1.00
120.0 1.00
3.0 0.67
1.0 1.00
4.0 1.00
1.0 1.00
6.0 0.67
1.0 1.00
15.0 0.80
3.0 1.00
706.0 1.00

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}225}]:} \PY{c+c1}{\PYZsh{} 115}
          \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{purity}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{N}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Purity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{k+kc}{None}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_56_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}214}]:} \PY{c+c1}{\PYZsh{} 27}
          \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{purity}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{N}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Purity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{k+kc}{None}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}208}]:} \PY{c+c1}{\PYZsh{} 75}
          \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{purity}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{N}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Purity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{k+kc}{None}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_58_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}203}]:} \PY{c+c1}{\PYZsh{} 50}
          \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{purity}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{n}{N}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Purity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{k+kc}{None}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_59_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{c+c1}{\PYZsh{}choice = np.random.randint(most\PYZus{}frequent.shape[0], size=100)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{choice} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{n}{word\PYZus{}counts}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}
         \PY{n}{counts\PYZus{}small} \PY{o}{=} \PY{n}{word\PYZus{}counts}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{n}{choice}\PY{p}{,} \PY{p}{:}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{Z} \PY{o}{=} \PY{n}{linkage}\PY{p}{(}\PY{n}{counts\PYZus{}small}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ward}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
         \PY{n}{dn} \PY{o}{=} \PY{n}{dendrogram}\PY{p}{(}\PY{n}{Z}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax.tick\PYZus{}params(axis=\PYZsq{}y\PYZsq{}, which=\PYZsq{}major\PYZsq{}, labelsize=15)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_63_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
borromeo 3142

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{n}{word\PYZus{}total\PYZus{}counts\PYZus{}sorted\PYZus{}ids}\PY{p}{[}\PY{n}{vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ice}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}90}]:} 8228
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{c+c1}{\PYZsh{} 1000 most frequent words}
         \PY{n}{frequent} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{index} \PY{o+ow}{in} \PY{n}{word\PYZus{}total\PYZus{}counts\PYZus{}sorted\PYZus{}ids}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{200}\PY{p}{]}\PY{p}{:}
             \PY{n}{frequent}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{inverse\PYZus{}dictionary}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{}[word\PYZus{}total\PYZus{}counts\PYZus{}sorted\PYZus{}ids[\PYZhy{}10:]]}
         \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{frequent}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}72}]:} array(['num', 'coord', 'rwy', 'and', 'to', 'twy', 'clsd', 'of', 'area',
                'fl', 'at', 'acft', 'for', 'due', 'the', 'btn', 'not', 'wi', 'ft',
                'avbl', 'on', 'nm', 'will', 'with', 'act', 'radius', 'ad', 'ils',
                'fm', 'aip', 'be', 'gps', 'mil', 'as', 'mhz', 'flt', 'rte', 'dme',
                'by', 'amsl', 'activated', 'airspace', 'wip', 'in', 'wet', 'flw',
                'exc', 'take', 'all', 'obs', 'place', 'km', 'agl', 'or', 'vor',
                'ref', 'sfc', 'dct', 'pct', 'info', 'maint', 'rmk', 'restricted',
                'raim', 'cat', 'radar', 'amdt', 'tempo', 'atc', 'psn', 'no', 'ep',
                'lgt', 'loc', 'apch', 'freq', 'are', 'ops', 'hr', 'min', 'is',
                'rnav', 'twr', 'circle', 'only', 'side', 'expect', 'proc',
                'system', 'tfc', 'ats', 'notam', 'may', 'opr', 'centre',
                'vectoring', 'end', 'danger', 'detection', 'point', 'line', 'jun',
                'fir', 'ctl', 'svc', 'fault', 'ch', 'hours', 'tso', 'obst',
                'outages', 'alt', 'ausots', 'civ', 'sup', 'enr', 'eg', 'either',
                'nr', 'coor', 'dep', 'equipped', 'departure', 'points', 'use',
                'centered', 'vfr', 'air', 'frng', 'suitable', 'via', 'lnav',
                'stand', 'vortac', 'na', 'deg', 'apron', 'thr', 'following', 'ctc',
                'app', 'nav', 'gp', 'papi', 'ldg', 'trk', 'gnd', 'year', 'crane',
                'flex', 'ifr', 'tel', 'flow', 'reserved', 'ndb', 'flight',
                'tracks', 'arp', 'warning', 'ser', 'aerodrome', 'this', 'ap',
                'rocket', 'group', 'hgt', 'north', 'activity', 'joining', 'fire',
                'availability', 'into', 'provided', 'bounded', 'airac', 'an',
                'anti', 'do', 'ctr', 'de', 'brg', 'rad', 'ppr', 'flying', 'prior',
                'document', 'hail', 'elev', 'lrr', 'rqrd', 'mag', 'blw', 'pje',
                'areas', 'effective', 'tkof', 'flights', 'up', 'jul', 'grass'],
               dtype='<U12')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{c+c1}{\PYZsh{} 1000 least frequent words}
          \PY{n}{frequent} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{index} \PY{o+ow}{in} \PY{n}{word\PYZus{}total\PYZus{}counts\PYZus{}sorted\PYZus{}ids}\PY{p}{[}\PY{l+m+mi}{18361}\PY{o}{\PYZhy{}}\PY{l+m+mi}{200}\PY{p}{:}\PY{l+m+mi}{18361}\PY{p}{]}\PY{p}{:}
              \PY{n}{frequent}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{inverse\PYZus{}dictionary}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{}[word\PYZus{}total\PYZus{}counts\PYZus{}sorted\PYZus{}ids[\PYZhy{}10:]]}
          \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{frequent}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}115}]:} array(['budworth', 'stilt', 'lepar', 'wymagaja', 'ytra', 'steza', 'ehrd',
                 'araclarini', 'tuxxi', 'maleme', 'gitle', 'effects', 'stephens',
                 'guimaraes', 'sokobanja', 'chiristie', 'guinea', 'chiquita',
                 'stetten', 'stettenhofen', 'budowlane', 'letala', 'letal', 'gitam',
                 'let', 'lesznowola', 'ytst', 'gisto', 'efkt', 'gurag', 'ehdl',
                 'laskun', 'vsa', 'lapwing', 'gimun', 'daman', 'lapex', 'lapan',
                 'stubs', 'stud', 'strzelin', 'gvo', 'laoag', 'whereas',
                 'chichester', 'studley', 'vichy', 'lans', 'electronic', 'wenlock',
                 'studenternas', 'laren', 'strzelce', 'managers', 'lasno', 'leaf',
                 'chieti', 'wamm', 'dobson', 'strovolos', 'elavo', 'dobrovice',
                 'chico', 'cinsi', 'lashenden', 'bulboaca', 'gomes', 'elbak',
                 'lasers', 'larnaca', 'catly', 'lari', 'vuosanka', 'softspots',
                 'elektirik', 'elektrocieplowni', 'vicenza', 'subitem',
                 'elicottero', 'landfill', 'turned', 'catiii', 'elimina', 'gzg',
                 'yr', 'lamung', 'lampoldshausen', 'bulundurmasi', 'lamphun',
                 'gigna', 'suboficial', 'dance', 'wembury', 'lamka', 'elimination',
                 'lamga', 'wrigley', 'aftm', 'aossp', 'gwc', 'damen', 'element',
                 'stupat', 'lanin', 'langweiler', 'elementary', 'elements',
                 'wypelnionych', 'vsat', 'elevazione', 'damir', 'mand', 'yrbt',
                 'lange', 'bulukumba', 'gwangju', 'gilep', 'subar', 'subay',
                 'mandalay', 'lasovo', 'dolny', 'ekeb', 'ccauv', 'gutierrez',
                 'sogta', 'dalbandin', 'lazio', 'vume', 'ekdap', 'builth', 'turzno',
                 'yshg', 'ekends', 'guvenilirdir', 'lawry', 'abana', 'mana',
                 'chillan', 'lastik', 'lav', 'ldsh', 'malta', 'ldpv', 'gustav',
                 'eilser', 'ld', 'curaumilla', 'strausberg', 'viewing', 'mam',
                 'eisenstadt', 'bugib', 'ysj', 'strazy', 'cattle', 'vietjet',
                 'gomez', 'disev', 'lcc', 'guru', 'ekmen', 'chinchilla', 'clients',
                 'bukovno', 'cattolica', 'laterite', 'laterales', 'vumpi',
                 'araucarias', 'eko', 'latecoere', 'mals', 'strasice', 'elamo',
                 'dakmo', 'victorville', 'yardimci', 'avedoere', 'were', 'lats',
                 'ginbata', 'gokten', 'lautoka', 'ekoda', 'guvenlik', 'stretch',
                 'bamford', 'guwahati', 'eksi', 'ekuti', 'stricly', 'laupheim',
                 'dall', 'vide', 'lauf', 'disina', 'aga', 'chinese', 'gurmencon'],
                dtype='<U16')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{c+c1}{\PYZsh{}print(word\PYZus{}total\PYZus{}counts[10])}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{word\PYZus{}counts}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{]}\PY{p}{)}
         \PY{n}{vectorizer}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{n}{word\PYZus{}counts}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
  (0, 11975)	1
  (0, 7181)	1
  (0, 19706)	1
  (0, 12876)	2
  (0, 4165)	1
  (0, 632)	1
  (0, 9386)	1
  (0, 14468)	1
  (0, 499)	3
  (0, 23034)	1
  (0, 8584)	1
  (0, 27495)	2
  (0, 1580)	1
  (0, 4653)	1
  (0, 20732)	1
  (0, 17944)	1
  (0, 4532)	1
  (0, 5106)	10
  (0, 17610)	7

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}38}]:} 'aa'
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{vectorizer}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{23034}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}41}]:} 'side'
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{} vectorizer.inverse\PYZus{}transform(np.argsort(word\PYZus{}total\PYZus{}counts)[:100])}
         \PY{p}{(}\PY{n}{word\PYZus{}total\PYZus{}counts}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} [array(['aa', 'aaa', 'aab', {\ldots}, 'zz', 'zzor', 'zzp'], dtype='<U32')]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{}print(vectorizer.vocabulary\PYZus{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{choice} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{n}{counts}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n}{counts\PYZus{}small} \PY{o}{=} \PY{n}{counts}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{n}{choice}\PY{p}{,} \PY{p}{:}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} word vectors using TF\PYZhy{}IDF}
         \PY{c+c1}{\PYZsh{}X\PYZus{}sparse = transformer.fit\PYZus{}transform(counts)}
         
         \PY{c+c1}{\PYZsh{}counts.toarray()}
         \PY{c+c1}{\PYZsh{} X\PYZus{}sparse = counts}
         \PY{c+c1}{\PYZsh{}X = X\PYZus{}sparse.toarray()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n+nb}{sum}\PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{counts\PYZus{}small} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}34}]:} 12124
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{cov} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{corrcoef}\PY{p}{(}\PY{n}{counts\PYZus{}small}\PY{p}{,} \PY{n}{rowvar}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{cov}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{np}\PY{o}{.}\PY{n}{isfinite}\PY{p}{(}\PY{n}{cov}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{l+m+mf}{0.0}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/anaconda3/lib/python3.5/site-packages/numpy/lib/function\_base.py:2400: RuntimeWarning: invalid value encountered in true\_divide
  c /= stddev[:, None]
/anaconda3/lib/python3.5/site-packages/numpy/lib/function\_base.py:2401: RuntimeWarning: divide by zero encountered in true\_divide
  c /= stddev[None, :]
/anaconda3/lib/python3.5/site-packages/numpy/lib/function\_base.py:2401: RuntimeWarning: invalid value encountered in true\_divide
  c /= stddev[None, :]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{c+c1}{\PYZsh{}cov.shape}
         \PY{c+c1}{\PYZsh{}cov.shape}
         
         \PY{n}{cov\PYZus{}highest} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{cov}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} what are the most correlated features?}
         \PY{c+c1}{\PYZsh{}np.unravel\PYZus{}index(cov.argmax(), cov.shape)}
         
         \PY{c+c1}{\PYZsh{}print(cov)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{unravel\PYZus{}index}\PY{p}{(}\PY{n}{cov\PYZus{}highest}\PY{p}{,} \PY{n}{cov}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}cov.shape[0]}
        
        \PY{n+nb}{sum}\PY{p}{(}\PY{n}{indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{indices}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}vectorizer.inverse\PYZus{}transform(indices[0][40000:40100])}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{} how many words appear less than 10 times?}
         
         \PY{c+c1}{\PYZsh{}word\PYZus{}sum = np.sum(counts, axis=0)}
         \PY{c+c1}{\PYZsh{}print(word\PYZus{}sum.shape)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{word\PYZus{}sum}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n}{word\PYZus{}sum}\PY{p}{[}\PY{n}{word\PYZus{}sum} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{10}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1, 28657)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} (1, 23036)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{} X\PYZus{}small = np.random.choice(X\PYZus{}sparse.toarray(), 100)}
         
         
         \PY{c+c1}{\PYZsh{}cov = np.cov(X\PYZus{}sparse.toarray().T)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        ValueError                                Traceback (most recent call last)

        <ipython-input-17-df66bdc04a33> in <module>()
    ----> 1 X\_small = np.random.choice(X\_sparse.toarray(), 100)
          2 
          3 
          4 \#cov = np.cov(X\_sparse.toarray().T)


        mtrand.pyx in mtrand.RandomState.choice()


        ValueError: a must be 1-dimensional

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}X\PYZus{}embedded = X\PYZus{}small}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}455}]:} \PY{n}{X}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{:}\PY{l+m+mi}{2000}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}455}]:} array([0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.09199204, 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.20762582, 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{counts} \PY{o}{=} \PY{n}{vectorizer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{corpus}\PY{p}{)}
         \PY{n}{X\PYZus{}sparse} \PY{o}{=} \PY{n}{transformer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{counts}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} X\PYZus{}sparse = counts}
         \PY{n}{X} \PY{o}{=} \PY{n}{X\PYZus{}sparse}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}222}]:} \PY{n}{choice} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}
          \PY{n}{X\PYZus{}small} \PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{n}{choice}\PY{p}{,} \PY{p}{:}\PY{p}{]}
          \PY{n}{y\PYZus{}small} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{supress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{n}{choice}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}223}]:} \PY{c+c1}{\PYZsh{}text\PYZus{}small = df[\PYZsq{}fulltext\PYZsq{}].values[choice]}
          \PY{c+c1}{\PYZsh{}text\PYZus{}small}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}244}]:} \PY{k}{def} \PY{n+nf}{break\PYZus{}lines}\PY{p}{(}\PY{n}{input\PYZus{}text}\PY{p}{,} \PY{n}{stride}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{)}\PY{p}{:}
              \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Break lines for a list of texts\PYZdq{}\PYZdq{}\PYZdq{}}
          
              \PY{n}{output\PYZus{}text} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{k}{for} \PY{n}{text} \PY{o+ow}{in} \PY{n}{input\PYZus{}text}\PY{p}{:}
                  \PY{n}{string} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
                  \PY{n}{ids} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{,} \PY{n}{stride}\PY{p}{)}
                  \PY{k}{for} \PY{n}{start}\PY{p}{,}\PY{n}{end} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{ids}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{ids}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                      \PY{n}{string} \PY{o}{+}\PY{o}{=} \PY{n}{text}\PY{p}{[}\PY{n}{start}\PY{p}{:} \PY{n}{end}\PY{p}{]}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}br\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}
                  \PY{n}{string} \PY{o}{+}\PY{o}{=} \PY{n}{text}\PY{p}{[}\PY{n}{end}\PY{p}{:}\PY{p}{]}
          
                  \PY{n}{output\PYZus{}text}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{string}\PY{p}{)}
              
              \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{output\PYZus{}text}\PY{p}{)}
          
          \PY{n}{text\PYZus{}small} \PY{o}{=} \PY{n}{break\PYZus{}lines}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fulltext}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{n}{choice}\PY{p}{]}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}text\PYZus{}small}
          
          \PY{c+c1}{\PYZsh{}type(text\PYZus{}small)}
          \PY{c+c1}{\PYZsh{}text\PYZus{}small}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}244}]:} array(['J5283/18 NOTAMR J5268/18 Q)RJJJ/QANCA/I/NBO/E/000/999/3812N1<br>3646E242 A)RJJJ B)1806290528 C)1806292100 E)REF AIP ENR 3.3 <br>CDR ARE ESTABLISHED AS FLW,     RTE         PERIOD          <br>       MNM APPLICABLE ALT 1)  Z16         1806291300/1806292<br>100  MEA 2)  Z17         1806291300/1806292100  MEA 3)  Z18 <br>        1806290800/1806292100  MEA 4)  Z21         180629080<br>0/1806292100  MEA 5)  Z162        1806290800/1806292100  MEA<br> 6)  Z171        1806290800/1806292100  MEA 7)  Z182        <br>1806290800/1806292100  MEA',
                 'A1169/18 NOTAMN Q)PHZH/QMXHW/IV/M/A/000/999/2054N15626W005 A<br>)PHOG B)1806021030 C)1806021530 E)TWY E BTN RWY 02/20 AND EA<br>ST RAMP WIP SFC PAINTING',
                 'M3749/18 NOTAMN Q)EBBU/QRTCA/IV/BO/W/095/999/5010N00455E039 <br>A)EBBU B)1806261300 C)1806280850 D)26 1300-1350, 28 0800-085<br>0 E)TEMPO SEGREGATED AREA EBTSA26A ARDENNES 01 ACTIVATED. -D<br>URING ACT EBTSA26A IS NOT PERMEABLE AND TG1 IS CLOSED. -GAT <br>TRAFFIC IS ALLOWED TO CROSS THE TSA26A ON THE TRACK MATIX - <br>MMD ON A FIXED FL AFTER COORD BTN BELGA RADAR AND CRNA/NORD.<br> THE TRAFFIC WILL REMAIN BELOW FL195. -TRANSITS FROM AND TO <br>FRANCE VIA RSL01,RSL10 AND RSL09 WILL NOT BE ALLOWED DURING <br>TSA26A ACT. - TRANSITS FROM AND TO GERMANY VIA DISKI (SOUTHE<br>RN CORRIDOR) WILL NOT BE ALLOWED DURING TSA26A ACT. - TO COO<br>RDINATE A TRANSIT FROM AND TO FRANCE DURING TSA26A ACT, CONT<br>ACT BELGA RADAR SUPERVISOR ON +3293892555. F)FL095 G)UNL',
                 {\ldots},
                 'A0424/18 NOTAMN Q)KZLA/QLPAS/IV/BO/A/000/999/3349N11809W005 <br>A)KLGB B)1806190500 C)1806231315 D)0500-1315 E)RWY 12 PAPI U<br>/S',
                 'P4854/18 NOTAMN Q)EPWW/QMRLC/IV/NBO/A/000/999/5227N02039E005<br> A)EPMO B)1806292200 C)1806300300 E)RWY 08/26 CLSD Z POWODU <br>WIP.',
                 'K6647/18 NOTAMN Q)UUWV/QRTCA/IV/BO/W/000/050/5735N04058E020 <br>A)UUWV B)1806070200 C)1806082359 D)DAILY 0200-2359 E)AIRSPAC<br>E CLSD WI 5KM EITHER SIDE OF LINE JOINING POINTS: 574600N041<br>2500E-574200N0404700E-574100N0403200E-572200N0403800E F)SFC <br>G)FL050'],
                dtype='<U3356')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}225}]:} \PY{c+c1}{\PYZsh{} from sklearn.manifold import TSNE}
          \PY{n}{X\PYZus{}embedded} \PY{o}{=} \PY{n}{TSNE}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}small}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}from sklearn.decomposition import PCA}
          \PY{c+c1}{\PYZsh{}pca = PCA(n\PYZus{}components=2)}
          \PY{c+c1}{\PYZsh{}X\PYZus{}embedded = pca.fit\PYZus{}transform(X\PYZus{}small)}
          
          \PY{n}{X\PYZus{}embedded}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}225}]:} (5000, 2)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}226}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{X\PYZus{}small}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
1.6504895951782452

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}227}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
          \PY{n}{x} \PY{o}{=} \PY{n}{X\PYZus{}embedded}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}
          \PY{n}{y} \PY{o}{=} \PY{n}{X\PYZus{}embedded}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
          
          
          \PY{c+c1}{\PYZsh{}z = X\PYZus{}embedded[:, 2]}
          
          \PY{n}{sup} \PY{o}{=} \PY{n}{y\PYZus{}small} \PY{o}{==} \PY{l+m+mi}{1}
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Not important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{frameon}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}227}]:} <matplotlib.legend.Legend at 0x1a28894fd0>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_89_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{k+kn}{import} \PY{n+nn}{plotly}
         \PY{n}{plotly}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}94}]:} '3.2.1'
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}230}]:} \PY{k+kn}{import} \PY{n+nn}{plotly}
          \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{plotly} \PY{k}{as} \PY{n+nn}{py}
          \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{graph\PYZus{}objs} \PY{k}{as} \PY{n+nn}{go}
          
          \PY{n}{plotly}\PY{o}{.}\PY{n}{offline}\PY{o}{.}\PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{(}\PY{n}{connected}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}plotly.offline.iplot(\PYZob{}}
          \PY{c+c1}{\PYZsh{}    \PYZdq{}data\PYZdq{}: [go.Scatter(x=[1, 2, 3, 4], y=[4, 3, 2, 1])],}
          \PY{c+c1}{\PYZsh{}    \PYZdq{}layout\PYZdq{}: go.Layout(title=\PYZdq{}hello world\PYZdq{})}
          \PY{c+c1}{\PYZsh{}\PYZcb{})}
          
          \PY{n}{trace0} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
              \PY{n}{x} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,}
              \PY{n}{y} \PY{o}{=} \PY{n}{y}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,}
              \PY{c+c1}{\PYZsh{}z = z[sup],}
          
              \PY{n}{name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Not important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{mode} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{marker} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}
                  \PY{n}{size} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
              \PY{p}{)}\PY{p}{,}
              \PY{n}{text} \PY{o}{=} \PY{n}{text\PYZus{}small}\PY{p}{[}\PY{n}{sup}\PY{p}{]}
          \PY{p}{)}
          
          \PY{n}{trace1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
              \PY{n}{x} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,}
              \PY{n}{y} \PY{o}{=} \PY{n}{y}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,}
              \PY{c+c1}{\PYZsh{}z = z[sup],}
              \PY{n}{name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{mode} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{marker} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}
                  \PY{n}{size} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
              \PY{p}{)}\PY{p}{,}
              \PY{n}{text} \PY{o}{=} \PY{n}{text\PYZus{}small}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}
          \PY{p}{)}
          
          
          \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{n}{trace0}\PY{p}{,} \PY{n}{trace1}\PY{p}{]}
          
          \PY{n}{layout}\PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}
              \PY{n}{autosize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
              \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,}
              \PY{n}{height}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,}
          
              \PY{n}{title}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOTAMs/t\PYZhy{}SNE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{hovermode}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{closest}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{xaxis}\PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}
                  \PY{n}{title}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{n}{ticklen}\PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
                  \PY{n}{zeroline}\PY{o}{=} \PY{k+kc}{False}\PY{p}{,}
                  \PY{n}{gridwidth}\PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,}
              \PY{p}{)}\PY{p}{,}
              \PY{n}{yaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}
                  \PY{n}{title}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{n}{ticklen}\PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
                  \PY{n}{gridwidth}\PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,}
              \PY{p}{)}\PY{p}{,}
              \PY{n}{showlegend}\PY{o}{=} \PY{k+kc}{False}
          \PY{p}{)}
          
          
          \PY{n}{fig} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{data}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}plotly.offline.iplot(fig)}
          \PY{n}{plotly}\PY{o}{.}\PY{n}{offline}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fig}\PY{p}{,} \PY{n}{filename}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOTAM\PYZus{}t\PYZus{}SNE.html}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}230}]:} 'file:///Users/coupon/projects/propulsion/Swiss/3\_Modelling/NOTAM\_t\_SNE.html'
\end{Verbatim}
            
    \hypertarget{gensim}{%
\subsection{Gensim}\label{gensim}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}306}]:} \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{test}\PY{n+nn}{.}\PY{n+nn}{utils} \PY{k}{import} \PY{n}{common\PYZus{}texts}
          \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models}\PY{n+nn}{.}\PY{n+nn}{doc2vec} \PY{k}{import} \PY{n}{Doc2Vec}\PY{p}{,} \PY{n}{TaggedDocument}
          \PY{k+kn}{from} \PY{n+nn}{gensim} \PY{k}{import} \PY{n}{corpora}\PY{p}{,} \PY{n}{models}\PY{p}{,} \PY{n}{similarities}
          
          
          \PY{c+c1}{\PYZsh{} remove common words and tokenize}
          \PY{n}{stoplist} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for a of the and to in}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n}{texts} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n}{word} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{document}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{word} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{stoplist}\PY{p}{]}
                   \PY{k}{for} \PY{n}{document} \PY{o+ow}{in} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text\PYZus{}clean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{values}\PY{p}{]}
          
          
          \PY{c+c1}{\PYZsh{}models.TfidfModel}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}304}]:} \PY{n}{documents} \PY{o}{=} \PY{p}{[}\PY{n}{TaggedDocument}\PY{p}{(}\PY{n}{doc}\PY{p}{,} \PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{doc} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{texts}\PY{p}{)}\PY{p}{]}
          \PY{c+c1}{\PYZsh{}documents}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}425}]:} \PY{n}{model} \PY{o}{=} \PY{n}{models}\PY{o}{.}\PY{n}{doc2vec}\PY{o}{.}\PY{n}{Doc2Vec}\PY{p}{(}\PY{n}{vector\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{500}\PY{p}{,} \PY{n}{min\PYZus{}count}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{window}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{build\PYZus{}vocab}\PY{p}{(}\PY{n}{documents}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{train}\PY{p}{(}\PY{n}{documents}\PY{p}{,} \PY{n}{total\PYZus{}examples}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{corpus\PYZus{}count}\PY{p}{,} \PY{n}{epochs}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{epochs}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        TypeError                                 Traceback (most recent call last)

        <ipython-input-425-a375901db6ed> in <module>()
          1 \#model = models.doc2vec.Doc2Vec(vector\_size=500, min\_count=1, window=1)
    ----> 2 model = models.TfidfModel.initialize()
          3 \#model.build\_vocab(documents)
          4 model.train(documents, total\_examples=model.corpus\_count, epochs=model.epochs)


        TypeError: initialize() missing 2 required positional arguments: 'self' and 'corpus'

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}429}]:} \PY{n}{models}\PY{o}{.}\PY{n}{TfidfModel}\PY{p}{(}\PY{n}{texts}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        ValueError                                Traceback (most recent call last)

        <ipython-input-429-415b435dce86> in <module>()
    ----> 1 models.TfidfModel(texts)
    

        /anaconda3/lib/python3.5/site-packages/gensim/models/tfidfmodel.py in \_\_init\_\_(self, corpus, id2word, dictionary, wlocal, wglobal, normalize, smartirs)
        304                 self.id2word = dictionary
        305         elif corpus is not None:
    --> 306             self.initialize(corpus)
        307         else:
        308             \# NOTE: everything is left uninitialized; presumably the model will


        /anaconda3/lib/python3.5/site-packages/gensim/models/tfidfmodel.py in initialize(self, corpus)
        330                 logger.info("PROGRESS: processing document \#\%i", docno)
        331             numnnz += len(bow)
    --> 332             for termid, \_ in bow:
        333                 dfs[termid] = dfs.get(termid, 0) + 1
        334 


        ValueError: too many values to unpack (expected 2)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}419}]:} \PY{n}{vectors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{documents}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{)}\PY{p}{)}
          \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{documents}\PY{p}{)}\PY{p}{:}
              \PY{n}{vectors}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{docvecs}\PY{p}{[}\PY{n}{i}\PY{p}{]}
              
          \PY{n}{X} \PY{o}{=} \PY{n}{vectors}
          
          
          \PY{n}{choice} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{5000}\PY{p}{)}
          \PY{n}{X\PYZus{}small} \PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{n}{choice}\PY{p}{,} \PY{p}{:}\PY{p}{]}
          \PY{n}{y\PYZus{}small} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{supress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{n}{choice}\PY{p}{]}
          
          \PY{c+c1}{\PYZsh{}X\PYZus{}embedded = X\PYZus{}small}
          
          \PY{c+c1}{\PYZsh{} from sklearn.manifold import TSNE}
          \PY{n}{X\PYZus{}embedded} \PY{o}{=} \PY{n}{TSNE}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}small}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}from sklearn.decomposition import PCA}
          \PY{c+c1}{\PYZsh{}pca = PCA(n\PYZus{}components=2)}
          \PY{c+c1}{\PYZsh{}X\PYZus{}embedded = pca.fit\PYZus{}transform(X\PYZus{}small)}
          
          \PY{n}{X\PYZus{}embedded}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}419}]:} (5000, 2)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}421}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
          \PY{n}{x} \PY{o}{=} \PY{n}{X\PYZus{}embedded}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}
          \PY{n}{y} \PY{o}{=} \PY{n}{X\PYZus{}embedded}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
          
          \PY{n}{sup} \PY{o}{=} \PY{n}{y\PYZus{}small} \PY{o}{==} \PY{l+m+mi}{1}
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Not important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{frameon}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}421}]:} <matplotlib.legend.Legend at 0x1a600c9668>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_98_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}344}]:} \PY{n}{vec} \PY{o}{=} \PY{n}{documents}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{words}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{vec}\PY{p}{)}
          
          \PY{n}{sims} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{docvecs}\PY{o}{.}\PY{n}{most\PYZus{}similar}\PY{p}{(}\PY{p}{[}\PY{n}{model}\PY{o}{.}\PY{n}{docvecs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{topn}\PY{o}{=}\PY{n+nb}{len}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{docvecs}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}print(sims[0][0])}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{documents}\PY{p}{[}\PY{n}{sims}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['airborne', 'warning', 'ctl', 'system', 'flight', 'will', 'take', 'place', 'area', '<coord>', '<coord>', '<coord>', '<coord>']
TaggedDocument(['airborne', 'warning', 'ctl', 'system', 'will', 'take', 'place', 'area', '<coord>', '<coord>', '<coord>', '<coord>', 'area', 'clsd', 'tfc', 'btn', 'fl<num>', 'fl<num>'], [61654])

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}317}]:} \PY{n}{vectors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{documents}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}\PY{p}{)}
          \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{documents}\PY{p}{)}\PY{p}{:}
              \PY{n}{vectors}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{infer\PYZus{}vector}\PY{p}{(}\PY{n}{t}\PY{o}{.}\PY{n}{words}\PY{p}{)}
              
              
              \PY{c+c1}{\PYZsh{}print( vectors[i,:])}
              \PY{c+c1}{\PYZsh{}break}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}258}]:} \PY{c+c1}{\PYZsh{} remove common words and tokenize}
          \PY{n}{stoplist} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for a of the and to in}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n}{texts} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n}{word} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{document}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{word} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{stoplist}\PY{p}{]}
                   \PY{k}{for} \PY{n}{document} \PY{o+ow}{in} \PY{n}{corpus}\PY{p}{]}
          
          \PY{c+c1}{\PYZsh{} remove words that appear only once}
          \PY{k+kn}{from} \PY{n+nn}{collections} \PY{k}{import} \PY{n}{defaultdict}
          \PY{n}{frequency} \PY{o}{=} \PY{n}{defaultdict}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
          \PY{k}{for} \PY{n}{text} \PY{o+ow}{in} \PY{n}{texts}\PY{p}{:}
              \PY{k}{for} \PY{n}{token} \PY{o+ow}{in} \PY{n}{text}\PY{p}{:}
                  \PY{n}{frequency}\PY{p}{[}\PY{n}{token}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
          \PY{n}{texts} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n}{token} \PY{k}{for} \PY{n}{token} \PY{o+ow}{in} \PY{n}{text} \PY{k}{if} \PY{n}{frequency}\PY{p}{[}\PY{n}{token}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{]}
                   \PY{k}{for} \PY{n}{text} \PY{o+ow}{in} \PY{n}{texts}\PY{p}{]}
          
          \PY{k+kn}{from} \PY{n+nn}{pprint} \PY{k}{import} \PY{n}{pprint}  \PY{c+c1}{\PYZsh{} pretty\PYZhy{}printer}
          \PY{c+c1}{\PYZsh{}pprint(texts)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}296}]:} \PY{n}{documents} \PY{o}{=} \PY{p}{[}\PY{n}{TaggedDocument}\PY{p}{(}\PY{n}{doc}\PY{p}{,} \PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{doc} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{texts}\PY{p}{)}\PY{p}{]}
          \PY{n}{model} \PY{o}{=} \PY{n}{Doc2Vec}\PY{p}{(}\PY{n}{documents}\PY{p}{,} \PY{n}{vector\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{window}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{min\PYZus{}count}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{workers}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}298}]:} \PY{n}{vectors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{texts}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
          \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{texts}\PY{p}{)}\PY{p}{:}
              \PY{n}{vectors}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{infer\PYZus{}vector}\PY{p}{(}\PY{n}{t}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{texts}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}268}]:} \PY{n}{dictionary} \PY{o}{=} \PY{n}{corpora}\PY{o}{.}\PY{n}{Dictionary}\PY{p}{(}\PY{n}{texts}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}print(dictionary.token2id)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}278}]:} \PY{c+c1}{\PYZsh{}corpus = [dictionary.doc2bow(text) for text in texts]}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{corpus}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
IOPub data rate exceeded.
The notebook server will temporarily stop sending output
to the client in order to avoid crashing it.
To change this limit, set the config variable
`--NotebookApp.iopub\_data\_rate\_limit`.

Current values:
NotebookApp.iopub\_data\_rate\_limit=1000000.0 (bytes/sec)
NotebookApp.rate\_limit\_window=3.0 (secs)


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}273}]:} \PY{n}{tfidf} \PY{o}{=} \PY{n}{models}\PY{o}{.}\PY{n}{TfidfModel}\PY{p}{(}\PY{n}{corpus}\PY{p}{)}
          \PY{n}{tfidf}
          
          \PY{c+c1}{\PYZsh{}index = similarities.SparseMatrixSimilarity(tfidf[corpus], num\PYZus{}features=12)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}282}]:} \PY{n}{tfidf}\PY{p}{[}\PY{n}{corpus}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}282}]:} [(30, 0.06720827110149225),
           (77, 0.10703027966446861),
           (78, 0.24867227945645176),
           (79, 0.3455633128625216),
           (80, 0.1222257253141751),
           (81, 0.3656720578386301),
           (82, 0.32170026033756605),
           (83, 0.29888933903896886),
           (84, 0.09131788555010037),
           (85, 0.36831392715911954),
           (86, 0.12229327552443915),
           (87, 0.40419493285427227),
           (88, 0.3727885343122836)]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}275}]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        TypeError                                 Traceback (most recent call last)

        <ipython-input-275-5ffd4b236b50> in <module>()
    ----> 1 index[0]
    

        /anaconda3/lib/python3.5/site-packages/gensim/interfaces.py in \_\_getitem\_\_(self, query)
        364                     query = [matutils.unitvec(v) for v in query]
        365                 else:
    --> 366                     query = matutils.unitvec(query)
        367         result = self.get\_similarities(query)
        368 


        /anaconda3/lib/python3.5/site-packages/gensim/matutils.py in unitvec(vec, norm)
        712 
        713     try:
    --> 714         first = next(iter(vec))  \# is there at least one element?
        715     except StopIteration:
        716         return vec


        TypeError: 'int' object is not iterable

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}353}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{docvecs}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        KeyError                                  Traceback (most recent call last)

        <ipython-input-353-4e2099ba2144> in <module>()
    ----> 1 print(list(model.docvecs))
    

        /anaconda3/lib/python3.5/site-packages/gensim/models/keyedvectors.py in \_\_getitem\_\_(self, index)
       1197                 return self.vectors\_docs[self.\_int\_index(index, self.doctags, self.max\_rawint)]
       1198             return vstack([self[i] for i in index])
    -> 1199         raise KeyError("tag '\%s' not seen in training corpus/invalid" \% index)
       1200 
       1201     def \_\_contains\_\_(self, index):


        KeyError: "tag '98547' not seen in training corpus/invalid"

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}357}]:} \PY{n}{vectors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{documents}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}\PY{p}{)}
          \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{documents}\PY{p}{)}\PY{p}{:}
              \PY{n}{vectors}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{docvecs}\PY{p}{[}\PY{n}{i}\PY{p}{]}
              
          \PY{n}{X} \PY{o}{=} \PY{n}{vectors}
          
          
          \PY{n}{choice} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
          \PY{n}{X\PYZus{}small} \PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{n}{choice}\PY{p}{,} \PY{p}{:}\PY{p}{]}
          \PY{n}{y\PYZus{}small} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{supress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{n}{choice}\PY{p}{]}
          
          \PY{c+c1}{\PYZsh{} from sklearn.manifold import TSNE}
          \PY{n}{X\PYZus{}embedded} \PY{o}{=} \PY{n}{TSNE}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}small}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}from sklearn.decomposition import PCA}
          \PY{c+c1}{\PYZsh{}pca = PCA(n\PYZus{}components=2)}
          \PY{c+c1}{\PYZsh{}X\PYZus{}embedded = pca.fit\PYZus{}transform(X\PYZus{}small)}
          
          \PY{n}{X\PYZus{}embedded}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}357}]:} (100, 2)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}360}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
          \PY{n}{x} \PY{o}{=} \PY{n}{X\PYZus{}embedded}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}
          \PY{n}{y} \PY{o}{=} \PY{n}{X\PYZus{}embedded}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
          
          \PY{n}{sup} \PY{o}{=} \PY{n}{y\PYZus{}small} \PY{o}{==} \PY{l+m+mi}{1}
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Not important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{frameon}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}360}]:} <matplotlib.legend.Legend at 0x1a555a2a58>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_112_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}422}]:} \PY{n}{text\PYZus{}small} \PY{o}{=} \PY{n}{break\PYZus{}lines}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fulltext}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{n}{choice}\PY{p}{]}\PY{p}{)}
          
          
          \PY{n}{plotly}\PY{o}{.}\PY{n}{offline}\PY{o}{.}\PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{(}\PY{n}{connected}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}plotly.offline.iplot(\PYZob{}}
          \PY{c+c1}{\PYZsh{}    \PYZdq{}data\PYZdq{}: [go.Scatter(x=[1, 2, 3, 4], y=[4, 3, 2, 1])],}
          \PY{c+c1}{\PYZsh{}    \PYZdq{}layout\PYZdq{}: go.Layout(title=\PYZdq{}hello world\PYZdq{})}
          \PY{c+c1}{\PYZsh{}\PYZcb{})}
          
          \PY{n}{trace0} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
              \PY{n}{x} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,}
              \PY{n}{y} \PY{o}{=} \PY{n}{y}\PY{p}{[}\PY{n}{sup}\PY{p}{]}\PY{p}{,}
              \PY{c+c1}{\PYZsh{}z = z[sup],}
          
              \PY{n}{name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Not important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{mode} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{marker} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}
                  \PY{n}{size} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
              \PY{p}{)}\PY{p}{,}
              \PY{n}{text} \PY{o}{=} \PY{n}{text\PYZus{}small}\PY{p}{[}\PY{n}{sup}\PY{p}{]}
          \PY{p}{)}
          
          \PY{n}{trace1} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
              \PY{n}{x} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,}
              \PY{n}{y} \PY{o}{=} \PY{n}{y}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}\PY{p}{,}
              \PY{c+c1}{\PYZsh{}z = z[sup],}
              \PY{n}{name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Important}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{mode} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{marker} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}
                  \PY{n}{size} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
              \PY{p}{)}\PY{p}{,}
              \PY{n}{text} \PY{o}{=} \PY{n}{text\PYZus{}small}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{sup}\PY{p}{]}
          \PY{p}{)}
          
          
          \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{n}{trace0}\PY{p}{,} \PY{n}{trace1}\PY{p}{]}
          
          \PY{n}{layout}\PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}
              \PY{n}{autosize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
              \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,}
              \PY{n}{height}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,}
          
              \PY{n}{title}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOTAMs/t\PYZhy{}SNE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{hovermode}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{closest}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
              \PY{n}{xaxis}\PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}
                  \PY{n}{title}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{n}{ticklen}\PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
                  \PY{n}{zeroline}\PY{o}{=} \PY{k+kc}{False}\PY{p}{,}
                  \PY{n}{gridwidth}\PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,}
              \PY{p}{)}\PY{p}{,}
              \PY{n}{yaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}
                  \PY{n}{title}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{n}{ticklen}\PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,}
                  \PY{n}{gridwidth}\PY{o}{=} \PY{l+m+mi}{2}\PY{p}{,}
              \PY{p}{)}\PY{p}{,}
              \PY{n}{showlegend}\PY{o}{=} \PY{k+kc}{False}
          \PY{p}{)}
          
          
          \PY{n}{fig} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{data}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}plotly.offline.iplot(fig)}
          \PY{n}{plotly}\PY{o}{.}\PY{n}{offline}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fig}\PY{p}{,} \PY{n}{filename}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOTAM\PYZus{}t\PYZus{}SNE.html}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}422}]:} 'file:///Users/coupon/projects/propulsion/Swiss/3\_Modelling/NOTAM\_t\_SNE.html'
\end{Verbatim}
            

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
